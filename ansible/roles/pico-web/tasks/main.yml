---
# Playbook that installs and configures picoCTF-web servers

# Need to load passwords from the vault for remote environments
- include_vars: group_vars/vault_remote_testing.yml
  when: "'env_remote_testing' in group_names"

- include: dependencies.yml
  tags:
    - network
    - dependency

- include: nodejs.yml
  tags:
    - network
    - dependency

- include: nginx.yml

- include: picoCTF-webapp.yml
  tags:
    - devploy

- include: gunicorn.yml

- include: auto_configure.yml

- name: Ensure nginx is running
  service: 
    name: nginx
    state: started
    enabled: yes
